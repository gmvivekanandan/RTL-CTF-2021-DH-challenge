from pwn import *
import re

HOST = "192.168.43.49"
PORT = 6666

r = remote(HOST, PORT)
print((r.recvuntil(b"4\n")).decode())

my_secret_A = 7
my_public_A = pow(5, my_secret_A, 23)
r.sendline(b"%b" % str.encode(str(my_public_A)))

print((r.recvuntil(b"10\n")).decode())

my_secret_B = 8
my_public_B = pow(5, my_secret_B, 23)
r.sendline(b"%b" % str.encode(str(my_public_B)))

secret = pow(10, my_secret_A, 23)
flag_res = (r.recvuntil(b"\n")).decode()

flag = re.findall("\w+\W+", flag_res)
print(flag_res)
new_flag = ''.join(flag)
dec_flag = ''.join([chr(ord(x) ^ secret) for x in new_flag])
print(dec_flag)
